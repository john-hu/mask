(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{252:function(e,t,a){e.exports=a(253)},253:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a.n(n),c=a(4),o=a(15),i=a(87),s=a.n(i),l=a(229),u=a.n(l),d=a(230),m=a.n(d),p=(a(262),a(283)),f=["mask","no mask"],g="16px sans-serif",h=[320,320],v=function(e,t,a){var n=e.naturalWidth,r=e.naturalHeight;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="#000000",a.fillRect(0,0,t.width,t.height);var c=Math.min(t.width/e.naturalWidth,t.height/e.naturalHeight),o=Math.round(n*c),i=Math.round(r*c);a.drawImage(e,0,0,n,r,(t.width-o)/2,(t.height-i)/2,o,i)},w=function(e){var t=document.getElementById(e),a=t.getContext("2d");return a.font=g,a.textBaseline="top",{canvas:t,ctx:a}},b=function(){var e=Object(o.a)(r.a.mark(function e(t){var a,n,o,i,s,l,u,d,m,p,f;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(c.a)(t,4),n=a[0],o=a[1],i=a[2],s=a[3],e.next=3,Promise.all([n.data(),o.data(),i.data(),s.data()]);case 3:return l=e.sent,u=Object(c.a)(l,4),d=u[0],m=u[1],p=u[2],f=u[3],e.abrupt("return",{boxesData:d,scoresData:m,classesData:p,validCount:f[0]});case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),D=function(e){var t,a=e.canvas,n=e.ctx,r=e.boxesData,o=e.scoresData,i=e.classesData,s=e.validCount;for(t=0;t<s;++t){var l=r.slice(4*t,4*(t+1)),u=Object(c.a)(l,4),d=u[0],m=u[1],p=u[2],h=u[3];d*=a.width,p*=a.width,m*=a.height;var v=p-d,w=(h*=a.height)-m,b=f[i[t]],D=o[t].toFixed(2);n.strokeStyle="#00FFFF",n.lineWidth=4,n.strokeRect(d,m,v,w),n.fillStyle="#00FFFF";var x=n.measureText(b+":"+D).width,j=parseInt(g,10);n.fillRect(d,m,x+4,j+4)}for(t=0;t<s;++t){var T=r.slice(4*t,4*(t+1)),O=Object(c.a)(T,3),k=O[0],y=O[1];k*=a.width,y*=a.height;var E=f[i[t]],F=o[t].toFixed(2);n.fillStyle="#000000",n.fillText(E+":"+F,k,y)}},x=function(){var e,t,a,n,l,u,d,f,g,x,j=(e=Object(i.useState)(0),t=Object(c.a)(e,2),a=t[0],n=t[1],l=Object(i.useState)(0),u=Object(c.a)(l,2),d=u[0],f=u[1],g=Object(i.useState)(0),x=Object(c.a)(g,2),{modelLoadTime:a,modelWarmupTime:d,detectTime:x[0],setModelLoadTime:n,setModelWarmupTime:f,setDetectTime:x[1]}),T=function(){var e=Object(i.useState)(""),t=Object(c.a)(e,2),a=t[0],n=t[1];return{preview:a,onDrop:Object(i.useCallback)(function(e,t,a){console.log("on drop",e,t,a),n(e.length+a.length>0?e[0].preview||a[0]:"")},[])}}(),O=T.preview,k=T.onDrop,y=function(e){var t=Object(i.useState)(null),a=Object(c.a)(t,2),n=a[0],s=a[1],l=e.setModelLoadTime,u=e.setModelWarmupTime,d=e.setDetectTime;Object(i.useEffect)(function(){Object(o.a)(r.a.mark(function e(){var t,a,n,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.setBackend("webgl");case 2:return e.sent||alert("No WebGL found. The performance may not be good."),t=(new Date).getTime(),e.next=7,p.loadGraphModel("./modeln/model.json");case 7:return a=e.sent,l((new Date).getTime()-t),console.log("load time",(new Date).getTime()-t),n=p.tidy(function(){return p.zeros([1].concat(h,[3]))}),c=(new Date).getTime(),e.next=14,a.executeAsync(n);case 14:u((new Date).getTime()-c),console.log("warmup time",(new Date).getTime()-c),s(a);case 17:case"end":return e.stop()}},e)}))()},[l,u]);var m=Object(i.useCallback)(function(e){n&&Object(o.a)(r.a.mark(function t(){var a,c,o,i,s,l,u,m,f,g,x;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=w("canvas"),c=a.canvas,o=a.ctx,v(e,c,o),i=p.tidy(function(){return p.image.resizeBilinear(p.browser.fromPixels(c),h).div(255).expandDims(0)}),s=(new Date).getTime(),t.next=6,n.executeAsync(i);case 6:return l=t.sent,d((new Date).getTime()-s),console.log("execute time",(new Date).getTime()-s),t.next=11,b(l);case 11:u=t.sent,m=u.boxesData,f=u.scoresData,g=u.classesData,x=u.validCount,p.dispose(l),D({canvas:c,ctx:o,boxesData:m,scoresData:f,classesData:g,validCount:x});case 18:case"end":return t.stop()}},t)}))()},[n,d]);return{model:n,detectImage:m}}(j),E=y.model,F=y.detectImage;return s.a.createElement("div",{align:"center"},"load: ",j.modelLoadTime," ms, warm up: ",j.modelWarmupTime," ","ms, detect: ",j.detectTime," ms",s.a.createElement("div",{className:"Dropzone-page"},E?s.a.createElement(m.a,{className:"Dropzone",accept:"image/jpeg, image/png, .jpg, .jpeg, .png",multiple:!1,onDrop:k},O?s.a.createElement("img",{alt:"upload preview",onLoad:function(e){return F(e.target)},className:"Dropzone-img",src:O}):"Choose or drop a file.",s.a.createElement("canvas",{id:"canvas",width:"640",height:"640"})):s.a.createElement("div",{className:"Dropzone"},"Loading model...")))},j=document.getElementById("root");u.a.render(s.a.createElement(x,null),j)},262:function(e,t,a){},268:function(e,t){},269:function(e,t){},277:function(e,t){},280:function(e,t){},281:function(e,t){},282:function(e,t){}},[[252,2,1]]]);
//# sourceMappingURL=main.6ffa43d7.chunk.js.map